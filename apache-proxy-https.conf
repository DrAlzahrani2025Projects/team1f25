<VirtualHost *:443>
    ServerName sec.cse.csusb.edu:443

    SSLEngine on
    SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
    SSLHonorCipherOrder on
    SSLCipherSuite "EECDH+ECDSA+AESGCM EECDH+aRSA+AESGCM EDH+aRSA+AESGCM EECDH+ECDSA+SHA384 EECDH+ECDSA+SHA256 EECDH+aRSA+SHA384 EECDH+aRSA+SHA256 EECDH+aRSA EECDH EDH+aRSA !RC4 !aNULL !MD5 !DSS"

    SSLCertificateFile "/etc/ssl/certs/sec_cse_csusb_edu_cert.cer"
    SSLCertificateKeyFile "/etc/ssl/private/sec_cse_csusb_edu.key"
    SSLCertificateChainFile "/etc/ssl/certs/sec_cse_csusb_edu_interm.cer"

    DocumentRoot "/var/www/html/"

    ProxyRequests Off
    ProxyPreserveHost On
    AllowEncodedSlashes NoDecode

    RequestHeader set X-Forwarded-Proto "https"
    RequestHeader set X-Forwarded-Port "443"

    RewriteEngine On

    ########################################
    # Streamlit reverse proxy for team0f25
    ProxyPass        /team0f25 http://localhost:5000/team0f25
    ProxyPassReverse /team0f25 http://localhost:5000/team0f25

    # WebSocket upgrade for Streamlit
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/team0f25/(.*) ws://localhost:5000/team0f25/$1 [P,L]
    ########################################
    # Streamlit reverse proxy for team1f25
    ProxyPass /team1f25 http://localhost:5001/team1f25
    ProxyPassReverse /team1f25 http://localhost:5001/team1f25

    # WebSocket upgrade for Streamlit
    RewriteCond %{HTTP:Upgrade} =websocket [NC]
    RewriteCond %{HTTP:Connection} upgrade [NC]
    RewriteRule ^/team1f25/(.*) ws://localhost:5001/team1f25/$1 [P,L]
    ########################################
</VirtualHost>